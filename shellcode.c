#include <stdio.h>
#include <windows.h>

int main()
{

    char* shellcode = \
	"\xbd\x80\x90\x04\x08\xbf\xc2\x90\x04\x08\x31"
"\xc9\xf7\xe1\x64\x8b\x41\x30\x8b\x40\x0c\x8b"
"\x70\x14\xad\x96\xad\x8b\x58\x10\x89\xd8\x68"
"\x8e\x4e\x0e\xec\x50\xff\xd5\x68\x6c\x6c\x61"
"\x61\x66\x81\x6c\x24\x02\x61\x61\x68\x33\x32"
"\x2e\x64\x68\x55\x73\x65\x72\x54\xff\xd0\x68"
"\xa8\xa2\x4d\xbc\x50\xff\xd5\x66\x83\xc4\x08"
"\x50\x8d\x34\x24\x89\x46\x04\x68\x7e\xd8\xe2"
"\x73\x53\xff\xd5\x89\x46\x08\x31\xd2\x31\xc9"
"\x52\x68\x50\x77\x6e\x64\x89\xe7\x52\x68\x59"
"\x65\x73\x73\x89\xe1\x52\x57\x51\x52\xff\x56"
"\x04\x31\xd2\x52\xff\x56\x08\x60\x8b\x6c\x24"
"\x24\x8b\x45\x3c\x8b\x54\x28\x78\x01\xea\x8b"
"\x4a\x18\x8b\x5a\x20\x01\xeb\x49\x8b\x34\x8b"
"\x01\xee\x56\xff\xd7\x66\x83\xc4\x04\x3b\x44"
"\x24\x28\x75\xed\x8b\x5a\x24\x01\xeb\x66\x8b"
"\x0c\x4b\x8b\x5a\x1c\x01\xeb\x8b\x04\x8b\x01"
"\xe8\x89\x44\x24\x1c\x61\xc3\x56\x57\x8b\x74"
"\x24\x0c\x31\xff\xfc\x31\xc0\xac\x38\xe0\x74"
"\x07\xc1\xcf\x0d\x01\xc7\xeb\xf2\x89\xf8\x5f"
"\x5e\xc3";

    printf("shellcode length: %i", strlen(shellcode));

    LPVOID lpAlloc = VirtualAlloc(0, 4096, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    memcpy(lpAlloc, shellcode, strlen(shellcode));

    ((void(*)())lpAlloc)();

    return 0;
}
